<!doctype html>
<html lang="pl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Generator NPC — Panel roboczy</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&family=Share+Tech+Mono&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="brand">
        <h1>Generator NPC</h1>
        <span>Etap 1 — Bestiariusz · Pancerze · Bronie</span>
      </div>
      <div class="actions">
        <button class="btn">Eksport</button>
        <button class="btn primary">Generuj kartę</button>
      </div>
    </header>

    <main class="layout">
      <aside class="sidebar">
        <section class="panel">
          <h2>Źródło danych</h2>
          <p class="text-muted">
            Dane są pobierane z pliku
            <a class="link" href="https://cutelittlegoat.github.io/Repozytorium/data.json">
              cutelittlegoat.github.io/Repozytorium/data.json
            </a>
            , bez modyfikacji źródła.
          </p>
        </section>

        <section class="panel">
          <h2>Wybór bazowy</h2>
          <div class="field">
            <label for="bestiary">Bestiariusz · Nazwa</label>
            <select id="bestiary">
              <option>Wybierz nazwę...</option>
              <option>Rekord testowy — Ghul</option>
              <option>Rekord testowy — Mechaniczny strażnik</option>
            </select>
          </div>
          <div class="field">
            <label for="bestiary-notes">Uwagi do rekordu</label>
            <textarea id="bestiary-notes" rows="3" placeholder="Opcjonalne notatki"></textarea>
          </div>
        </section>

        <section class="panel">
          <h2>Moduły aktywne</h2>
          <div class="checkbox-list">
            <label class="checkbox">
              <input type="checkbox" checked />
              <span>Pancerz — nadpisz WP i cechy.</span>
            </label>
            <label class="checkbox">
              <input type="checkbox" checked />
              <span>Broń — ustaw ataki i cechy.</span>
            </label>
          </div>
        </section>

        <section class="panel">
          <h2>Moduły planowane</h2>
          <div class="checkbox-list">
            <label class="checkbox">
              <input type="checkbox" disabled />
              <span>Psionika — przygotować check-boxy pod zdolności.</span>
            </label>
            <label class="checkbox">
              <input type="checkbox" disabled />
              <span>Modlitwy — wstępny blok wyboru zaklęć.</span>
            </label>
            <label class="checkbox">
              <input type="checkbox" disabled />
              <span>Talenty — miejsce na listę pasywną.</span>
            </label>
            <label class="checkbox">
              <input type="checkbox" disabled />
              <span>Ekwipunek — sloty przedmiotów.</span>
            </label>
            <label class="checkbox">
              <input type="checkbox" disabled />
              <span>Augmentacje — uzupełnienie modyfikacji.</span>
            </label>
          </div>
        </section>

        <section class="panel">
          <h2>Ostrzeżenia formatowania</h2>
          <p class="text-muted">
            Jeżeli w danych pojawiają się odnośniki lub czerwone oznaczenia, zachowaj te same znaki
            interpunkcyjne (przecinki, średniki) oraz wyróżnienie <span class="text-red">czerwoną
            czcionką</span>.
          </p>
        </section>
      </aside>

      <section class="workspace">
        <div class="card">
          <h3>Podgląd bazowy <span class="badge">Bestiariusz</span></h3>
          <table class="data-table">
            <thead>
              <tr>
                <th>Klucz</th>
                <th>Wartość</th>
                <th>Akcje</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Odporność (w tym WP)</td>
                <td>8 (2)</td>
                <td><button class="row-toggle" data-row="row-1">Zwiń / Rozwiń</button></td>
              </tr>
              <tr id="row-1" class="row-details" hidden>
                <td colspan="3">
                  Szczegóły: bazowa odporność 6 + WP 2, bez dodatkowych modyfikatorów.
                </td>
              </tr>
              <tr>
                <td>Wartość Pancerza</td>
                <td>2</td>
                <td><button class="row-toggle" data-row="row-2">Zwiń / Rozwiń</button></td>
              </tr>
              <tr id="row-2" class="row-details" hidden>
                <td colspan="3">
                  Szczegóły: wartość wynikowa do nadpisania po wyborze pancerzy.
                </td>
              </tr>
              <tr>
                <td>Cechy</td>
                <td>
                  <span class="tag" data-trait="Nieporęczny">Nieporęczny (2)</span>
                  <span class="tag" data-trait="Ciężki">Ciężki</span>
                </td>
                <td><button class="row-toggle" data-row="row-3">Zwiń / Rozwiń</button></td>
              </tr>
              <tr id="row-3" class="row-details" hidden>
                <td colspan="3">
                  Szczegóły: kliknij tag, aby zobaczyć opis cechy w panelu podpowiedzi.
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="card">
          <h3>Wybór Pancerzy</h3>
          <div class="field">
            <label for="armor">Pancerze (wielokrotny wybór)</label>
            <select id="armor" multiple>
              <option>Pancerz płytowy</option>
              <option>Pancerz skórzany</option>
              <option>Pancerz taktyczny</option>
            </select>
          </div>
          <p class="notice">
            Najwyższe WP nadpisuje wartość pancerza, a cechy pancerza są scalane i
            rozdzielane średnikiem.
          </p>
        </div>

        <div class="card">
          <h3>Wybór Broni</h3>
          <div class="field">
            <label for="weapon">Bronie (wielokrotny wybór)</label>
            <select id="weapon" multiple>
              <option>Karabin szturmowy</option>
              <option>Młot bojowy</option>
              <option>Pistolet energetyczny</option>
            </select>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>Atak</th>
                <th>Parametry</th>
                <th>Cechy</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Karabin szturmowy</td>
                <td>2k10, DK 3, PP 1, Zasięg 30, Sz 3</td>
                <td>
                  <span class="tag" data-trait="Szybkostrzelna">Szybkostrzelna</span>
                  <span class="tag" data-trait="Głośna">Głośna</span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="card">
          <h3>Podsumowanie</h3>
          <p>
            Wersja robocza UI zachowuje mechanizm tagów cech, zwijanie wierszy i miejsce na
            kolejne moduły. Dodatkowe pola będą rozszerzane po integracji danych.
          </p>
        </div>

        <p class="footer">
          Generator NPC — UI roboczy. Zakres: Bestiariusz, Pancerze, Bronie, przygotowanie pod
          Psionikę, Modlitwy, Talenty, Ekwipunek i Augmentacje.
        </p>
      </section>
    </main>

    <aside class="popover" id="trait-popover">
      <h4 id="trait-title">Opis cechy</h4>
      <p id="trait-description">Kliknij tag, aby zobaczyć opis cechy.</p>
    </aside>

    <script>
      const popover = document.querySelector("#trait-popover");
      const popoverTitle = document.querySelector("#trait-title");
      const popoverDescription = document.querySelector("#trait-description");

      document.querySelectorAll(".row-toggle").forEach((button) => {
        button.addEventListener("click", () => {
          const rowId = button.getAttribute("data-row");
          const row = document.getElementById(rowId);
          const isHidden = row.hasAttribute("hidden");
          if (isHidden) {
            row.removeAttribute("hidden");
          } else {
            row.setAttribute("hidden", "");
          }
        });
      });

      document.querySelectorAll(".tag").forEach((tag) => {
        tag.addEventListener("click", () => {
          const traitName = tag.getAttribute("data-trait") || tag.textContent;
          popoverTitle.textContent = traitName;
          popoverDescription.textContent =
            "Opis cechy pojawi się po podłączeniu sekcji _meta.traits z data.json.";
          popover.classList.add("active");
        });
      });

      document.addEventListener("click", (event) => {
        if (event.target.closest(".tag")) {
          return;
        }
        if (!event.target.closest(".popover")) {
          popover.classList.remove("active");
        }
      });
    </script>
  </body>
</html>
